---
import Layout from "~/layouts/admin-layout.astro";
import AdminSidebar from "../../components/Admin-site/admin-sidebar.astro";
import AdminTopbar from "../../components/Admin-site/admin-topbar.astro";
// Complex branding to show in admin UI
const complexName = 'Komplek Anggrek Asri';
const complexImage = 'https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=100&h=100&fit=crop&crop=center';
---

<Layout>
  <AdminSidebar slot="sidebar" complexName={complexName} complexImage={complexImage} />
  <AdminTopbar slot="topbar" complexName={complexName} complexImage={complexImage} />

  <section class="header-card">
    <div class="header-left">
      <div class="icon"><i class="fas fa-bell"></i></div>
      <div>
        <h1>Notifikasi</h1>
        <p>Kelola preferensi notifikasi dan lihat riwayat aktivitas terbaru.</p>
      </div>
    </div>
  </section>

  <section class="notifications-widget">
    <div class="section-header">
      <h2><i class="fas fa-bell"></i> Notifikasi</h2>
      <div class="header-actions">
        <button class="btn" id="mark-all"><i class="fas fa-check-double"></i> Tandai semua dibaca</button>
        <button class="btn secondary" id="clear-all"><i class="fas fa-trash"></i> Bersihkan</button>
      </div>
    </div>
    <div class="notifications-list" id="notif-list">
      <div class="notification-item unread">
        <div class="notification-icon warning">
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        <div class="notification-content">
          <h4>Pembayaran Tertunda</h4>
          <p>5 warga belum melakukan pembayaran iuran bulan ini</p>
          <span class="notification-time">2 jam yang lalu</span>
        </div>
        <div class="notification-actions">
          <button class="btn-icon" aria-label="Tandai dibaca">
            <i class="fas fa-check"></i>
          </button>
        </div>
      </div>

      <div class="notification-item">
        <div class="notification-icon success">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="notification-content">
          <h4>Laporan Bulanan Selesai</h4>
          <p>Laporan keuangan bulan Juli telah selesai dibuat</p>
          <span class="notification-time">Kemarin, 15:30</span>
        </div>
        <div class="notification-actions">
          <button class="btn-icon" aria-label="Tandai dibaca">
            <i class="fas fa-check"></i>
          </button>
        </div>
      </div>

      <div class="notification-item">
        <div class="notification-icon info">
          <i class="fas fa-info-circle"></i>
        </div>
        <div class="notification-content">
          <h4>Warga Baru</h4>
          <p>2 keluarga baru telah terdaftar di sistem</p>
          <span class="notification-time">2 hari yang lalu</span>
        </div>
        <div class="notification-actions">
          <button class="btn-icon" aria-label="Tandai dibaca">
            <i class="fas fa-check"></i>
          </button>
        </div>
      </div>
    </div>
  </section>

  <style>
    :root { --gap: 16px; }
    .header-card { background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:14px 16px; box-shadow:0 8px 24px rgba(2,6,23,0.06); margin-bottom:16px; }
    .header-left { display:flex; align-items:center; gap:12px; }
    .header-left h1 { margin:0; font-size:1.4rem; font-weight:800; }
    .header-left p { margin:2px 0 0; color:#64748b; font-weight:600; }
    .icon { width:44px; height:44px; display:grid; place-items:center; border-radius:12px; background:#fff7ed; color:#ea580c; border:1px solid #fed7aa; }

    /* Notifications styles mirrored from dashboard */
    .notifications-widget {
      background: var(--surface); border: 1px solid var(--outline);
      border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); overflow: hidden;
    }
    .notifications-widget .section-header {
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding: 14px 16px; border-bottom: 1px solid var(--outline);
    }
    .notifications-widget .section-header h2 { margin:0; font-weight:800; }
    .header-actions { display:flex; gap:10px; }
    .notifications-list { display: grid; gap: 10px; padding: 12px; }
    .notification-item {
      display: grid; grid-template-columns: auto 1fr auto; gap: 12px; align-items: center;
      background: var(--surface-2); border: 1px solid var(--outline); border-radius: var(--radius-md);
      padding: 12px;
    }
    .notification-item.unread { border-left: 5px solid var(--primary); }
    .notification-icon {
      width: 40px; height: 40px; display: grid; place-items: center;
      border-radius: 10px; background: #fff; border: 1px solid var(--outline);
    }
    .notification-icon.warning { color:#b87300; background:#fff6e6; border-color:#f1e2c4; }
    .notification-icon.success { color:#0c6b2f; background:#e8f6ee; border-color:#d7eadf; }
    .notification-icon.info    { color:#0a6791; background:#e9f6ff; border-color:#cfe8fb; }
    .notification-content h4 { margin: 0; font-weight: 800; }
    .notification-content p { margin: 2px 0; color: var(--text-muted); }
    .notification-time { font-size: .85rem; color: var(--text-subtle); }
    .notification-actions .btn-icon {
      width: 34px; height: 34px; display: inline-flex; align-items: center; justify-content: center;
      border: 1px solid var(--outline); border-radius: 8px; background: var(--surface);
    }
    @media (max-width: 640px){
      .notification-item { grid-template-columns: auto 1fr; }
      .notification-actions { justify-self: end; }
    }

    .btn { display:inline-flex; align-items:center; gap:8px; height:36px; padding:0 12px; border-radius:10px; border:1px solid #e5e7eb; background:#f3f4f6; color:#111827; font-weight:800; }
    .btn.primary { background:#4f46e5; color:#fff; border-color:#4338ca; }
    .btn.secondary { background:#eef2ff; color:#3730a3; border-color:#c7d2fe; }
  </style>

  <script>
    // Interaksi sederhana: tandai dibaca dan bersihkan (plain JS)
    document.addEventListener('DOMContentLoaded', function(){
      const list = document.getElementById('notif-list');
      const clearBtn = document.getElementById('clear-all');
      const markAllBtn = document.getElementById('mark-all');

      document.addEventListener('click', function(e){
        const target = e.target;
        if (!(target instanceof Element)) return;
        const btn = target.closest('.notification-item .btn-icon');
        if (!btn) return;
        const item = btn.closest('.notification-item');
        if (item) item.classList.remove('unread');
      });

      if (clearBtn && list) {
        clearBtn.addEventListener('click', function(){
          list.innerHTML = '';
        });
      }
      if (markAllBtn && list) {
        markAllBtn.addEventListener('click', function(){
          list.querySelectorAll('.notification-item').forEach(function(item){
            item.classList.remove('unread');
          });
        });
      }
    });
  </script>
</Layout>
