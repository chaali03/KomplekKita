---
// Admin Topbar Component
// Modern UI/UX Design
---

<div class="admin-topbar pre-animation">
  <div class="topbar-left">
    <button class="menu-toggle" aria-label="Toggle Sidebar">
      <i class="fas fa-bars"></i>
    </button>
    <div class="page-title">
      <h2><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
      <div class="breadcrumbs">
        <a href="/admin">Admin</a>
        <span class="separator">/</span>
        <span>Dashboard</span>
      </div>
    </div>
  </div>
  
  <div class="topbar-right">
    <div class="topbar-actions">
      <div class="action-dropdown">
        <button class="action-button" data-tooltip="Notifikasi" id="notification-toggle">
          <i class="fas fa-bell"></i>
          <span class="badge pulse">3</span>
        </button>
        <div class="dropdown-panel notification-panel" id="notification-panel">
          <div class="panel-header">
            <h3>Notifikasi</h3>
            <button class="panel-action" data-tooltip="Tandai semua dibaca">
              <i class="fas fa-check-double"></i>
            </button>
          </div>
          <div class="panel-body">
            <div class="notification-item unread">
              <div class="notification-icon primary">
                <i class="fas fa-money-bill-wave"></i>
              </div>
              <div class="notification-content">
                <h4>Pembayaran Diterima</h4>
                <p>Pembayaran iuran bulan ini telah diterima</p>
                <span class="notification-time">Baru saja</span>
              </div>
              <button class="btn-icon" data-tooltip="Tandai dibaca">
                <i class="fas fa-circle"></i>
              </button>
            </div>
            <div class="notification-item unread">
              <div class="notification-icon warning">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
              <div class="notification-content">
                <h4>Pengingat Pembayaran</h4>
                <p>Tenggat pembayaran iuran 3 hari lagi</p>
                <span class="notification-time">2 jam yang lalu</span>
              </div>
              <button class="btn-icon" data-tooltip="Tandai dibaca">
                <i class="fas fa-circle"></i>
              </button>
            </div>
            <div class="notification-item">
              <div class="notification-icon success">
                <i class="fas fa-check-circle"></i>
              </div>
              <div class="notification-content">
                <h4>Laporan Bulanan</h4>
                <p>Laporan keuangan bulan lalu telah selesai</p>
                <span class="notification-time">Kemarin</span>
              </div>
            </div>
          </div>
          <div class="panel-footer">
            <a href="/admin/notifikasi" class="view-all">
              Lihat semua notifikasi <i class="fas fa-arrow-right"></i>
            </a>
          </div>
        </div>
      </div>
      
      <div class="theme-toggle" data-tooltip="Ganti Tema">
        <button class="action-button" id="theme-toggle-btn">
          <i class="fas fa-moon"></i>
        </button>
      </div>
      
      <div class="user-dropdown">
        <button class="user-button" id="user-dropdown-toggle">
          <img src="https://ui-avatars.com/api/?name=Admin&background=4f46e5&color=fff" alt="User Avatar" />
          <div class="user-info">
            <span class="user-name">Admin</span>
            <span class="user-role">Administrator</span>
          </div>
          <i class="fas fa-chevron-down"></i>
        </button>
        <div class="dropdown-menu" id="user-dropdown-menu">
          <a href="/admin/profil" class="dropdown-item">
            <i class="fas fa-user"></i> Profil
          </a>
          <a href="/admin/pengaturan" class="dropdown-item">
            <i class="fas fa-cog"></i> Pengaturan
          </a>
          <a href="/admin/upgrade" class="dropdown-item highlight">
            <i class="fas fa-crown"></i> Upgrade ke Premium
          </a>
          <div class="dropdown-divider"></div>
          <a href="/logout" class="dropdown-item">
            <i class="fas fa-sign-out-alt"></i> Keluar
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Initialize dropdown functionality
  document.addEventListener('DOMContentLoaded', function() {
    // User dropdown
    const userDropdownToggle = document.getElementById('user-dropdown-toggle') as HTMLButtonElement | null;
    const userDropdownMenu = document.getElementById('user-dropdown-menu') as HTMLElement | null;
    
    if (userDropdownToggle && userDropdownMenu) {
      userDropdownToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        userDropdownMenu.classList.toggle('show');
      });
    }
    
    // Notification panel
    const notificationToggle = document.getElementById('notification-toggle') as HTMLButtonElement | null;
    const notificationPanel = document.getElementById('notification-panel') as HTMLElement | null;
    
    if (notificationToggle && notificationPanel) {
      notificationToggle.addEventListener('click', function(e) {
        e.stopPropagation();
        notificationPanel.classList.toggle('show');
        userDropdownMenu?.classList.remove('show');
      });
    }
    
    // Theme toggle
    const themeToggleBtn = document.getElementById('theme-toggle-btn') as HTMLButtonElement | null;
    const htmlElement = document.documentElement;
    
    if (themeToggleBtn) {
      // Check for saved theme preference or respect OS preference
      const savedTheme = localStorage.getItem('theme');
      const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      
      if (savedTheme === 'dark' || (!savedTheme && systemPrefersDark)) {
        htmlElement.classList.add('dark-theme');
        themeToggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
      }
      
      themeToggleBtn.addEventListener('click', function() {
        htmlElement.classList.toggle('dark-theme');
        
        if (htmlElement.classList.contains('dark-theme')) {
          localStorage.setItem('theme', 'dark');
          themeToggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
        } else {
          localStorage.setItem('theme', 'light');
          themeToggleBtn.innerHTML = '<i class="fas fa-moon"></i>';
        }
      });
    }
    
    // Close all dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      const target = e.target as Element | null;
      if (!target?.closest('.user-dropdown')) {
        userDropdownMenu?.classList.remove('show');
      }
      
      if (!target?.closest('.action-dropdown')) {
        notificationPanel?.classList.remove('show');
      }
    });
  });
</script>